<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue article.dtd?><?DTDIdentifier.IdentifierType system?><?SourceDTD.DTDName article.dtd?><?SourceDTD.Version 1.0?><?ConverterInfo.XSLTName bmc2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id><journal-title-group><journal-title>BMC Evolutionary Biology</journal-title></journal-title-group><issn pub-type="epub">1471-2148</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3126739</article-id><article-id pub-id-type="publisher-id">1471-2148-11-145</article-id><article-id pub-id-type="pmid">21619569</article-id><article-id pub-id-type="doi">10.1186/1471-2148-11-145</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Context-dependent codon partition models provide significant increases in model fit in atpB and rbcL protein-coding genes</article-title></title-group><contrib-group><contrib contrib-type="author" id="A1"><name><surname>Baele</surname><given-names>Guy</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>guy.baele@psb.vib-ugent.be</email></contrib><contrib contrib-type="author" corresp="yes" id="A2"><name><surname>Van de Peer</surname><given-names>Yves</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>yves.vandepeer@psb.vib-ugent.be</email></contrib><contrib contrib-type="author" id="A3"><name><surname>Vansteelandt</surname><given-names>Stijn</given-names></name><xref ref-type="aff" rid="I4">4</xref><email>stijn.vansteelandt@ugent.be</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Plant Systems Biology, VIB, B-9052 Ghent, Belgium</aff><aff id="I2"><label>2</label>Bioinformatics and Evolutionary Genomics, Department of Molecular Genetics, Ghent University, B-9052 Ghent, Belgium</aff><aff id="I3"><label>3</label>Department of Microbiology and Immunology, Rega Institute, K.U. Leuven, Kapucijnenvoer 33 blok I bus 7001, B-3000 Leuven, Belgium</aff><aff id="I4"><label>4</label>Department of Applied Mathematics and Computer Science, Ghent University, Krijgslaan 281 S9, B-9000 Ghent, Belgium</aff><pub-date pub-type="collection"><year>2011</year></pub-date><pub-date pub-type="epub"><day>27</day><month>5</month><year>2011</year></pub-date><volume>11</volume><fpage>145</fpage><lpage>145</lpage><history><date date-type="received"><day>5</day><month>1</month><year>2011</year></date><date date-type="accepted"><day>27</day><month>5</month><year>2011</year></date></history><permissions><copyright-statement>Copyright &#x000a9;2011 Baele et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2011</copyright-year><copyright-holder>Baele et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="http://www.biomedcentral.com/1471-2148/11/145"/><abstract><sec><title>Background</title><p>Accurate modelling of substitution processes in protein-coding sequences is often hampered by the computational burdens associated with full codon models. Lately, codon partition models have been proposed as a viable alternative, mimicking the substitution behaviour of codon models at a low computational cost. Such codon partition models however impose independent evolution of the different codon positions, which is overly restrictive from a biological point of view. Given that empirical research has provided indications of context-dependent substitution patterns at four-fold degenerate sites, we take those indications into account in this paper.</p></sec><sec><title>Results</title><p>We present so-called context-dependent codon partition models to assess previous empirical claims that the evolution of four-fold degenerate sites is strongly dependent on the composition of its two flanking bases. To this end, we have estimated and compared various existing independent models, codon models, codon partition models and context-dependent codon partition models for the atpB and rbcL genes of the chloroplast genome, which are frequently used in plant systematics. Such context-dependent codon partition models employ a full dependency scheme for four-fold degenerate sites, whilst maintaining the independence assumption for the first and second codon positions.</p></sec><sec><title>Conclusions</title><p>We show that, both in the atpB and rbcL alignments of a collection of land plants, these context-dependent codon partition models significantly improve model fit over existing codon partition models. Using Bayes factors based on thermodynamic integration, we show that in both datasets the same context-dependent codon partition model yields the largest increase in model fit compared to an independent evolutionary model. Context-dependent codon partition models hence perform closer to codon models, which remain the best performing models at a drastically increased computational cost, compared to codon partition models, but remain computationally interesting alternatives to codon models. Finally, we observe that the substitution patterns in both datasets are drastically different, leading to the conclusion that combined analysis of these two genes using a single model may not be advisable from a context-dependent point of view.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>While the modelling of evolutionary processes in non-coding sequences has received much attention from a context-dependence point of view in the last two decades, the same cannot be said for modelling approaches for coding sequences, at least not in terms of developed model-based approaches. With the advent of new evolutionary models and drastic increases in computation power during the past decades, with desktop machines becoming more powerful and the advent of computer clusters with large amounts of processors (and processor cores) and a vast amount of memory, Maximum likelihood and Bayesian MCMC approaches now allow for very complex evolutionary models to be used in the analysis of large alignments.</p><p>Probabilistic modelling of sequence evolution has become the norm in phylogenetic inference, but complex evolutionary models are often not used in studies on molecular evolution, in part due to their increased computational burden but mainly due to the absence of such models in popular model testing tools [<xref ref-type="bibr" rid="B1">1</xref>]. Indeed, while researchers are widely adopting model selection techniques in phylogenetics in order to select the model that best fits their dataset, this may be problematic when complex evolutionary models are not included in popular model selection tools, such as Modeltest [<xref ref-type="bibr" rid="B2">2</xref>]. For example, in the case of analyzing protein-coding sequences, one needs to make sure to incorporate codon models as well as codon partition models in the model selection procedure.</p><p>Chloroplast genes, such as atpB and rbcL (the subjects of the analyses in this paper), are protein-coding genes that are often analyzed in concatenated alignments with non-coding sequences using independent nucleotide models (see e.g. [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]) or on their own using independent nucleotide models (see e.g. [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]). While the choice for an independent model of evolution, such as the general time-reversible model (GTR; [<xref ref-type="bibr" rid="B7">7</xref>]) in combination with varying rates across sites (RAS; e.g. [<xref ref-type="bibr" rid="B8">8</xref>]), is easily made in the case of non-coding sequences, such a choice is questionable when analyzing protein-coding sequences. Indeed, an inappropriate choice of evolutionary model can affect the outcome of any phylogenetic analysis (see [<xref ref-type="bibr" rid="B1">1</xref>] for an overview).</p><p>Models of codon substitution (i.e. full codon models) consider a codon triplet as the unit of evolution and can distinguish between synonymous and non-synonymous substitutions when analyzing protein-coding sequences [<xref ref-type="bibr" rid="B9">9</xref>]. This way, they are particularly effective in detecting signals of natural selection acting on the protein. An example of such a full codon model is the model of Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>]. Even though the use of this model is computationally demanding due to the increased dimension of the substitution matrix, it is well suited for uncovering both recent and ancient divergences [<xref ref-type="bibr" rid="B9">9</xref>]. Another category of models to analyse protein-coding sequences are the so-called codon partition models, which use different nucleotide-based models to describe the evolutionary process at the different codon positions [<xref ref-type="bibr" rid="B1">1</xref>]. Codon partition models allow for different models of substitution for different partitions of the data. While full codon models - like the model of Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>] - model biological reality more closely, codon partition models are much more computationally efficient [<xref ref-type="bibr" rid="B1">1</xref>].</p><p>In this paper, we aim to provide an overview of current codon partition models and present an extension of these models based upon previous empirical observations. Morton [<xref ref-type="bibr" rid="B11">11</xref>] studied the rbcL and ndhF genes from the chloroplast genome for signs of context dependence. Specifically, the author tested substitutions at four-fold degenerate sites for the existence of a correlation between neighbouring base composition and substitution bias and found that substitution bias, as measured by the proportion of transversions, is significantly different when neighbouring bases differ in their A+T contents. By performing chi-square tests for correlation on the numbers of observed transversions at four-fold degenerate sites and the A+T content of its neighbouring bases, Morton [<xref ref-type="bibr" rid="B11">11</xref>] found a significant difference in proportion of transversions in the three possible contexts (i.e. the three different levels of A+T content), both in an rbcL and ndhF dataset. These observations serve as the inspiration for this paper.</p><p>Here, we provide an overview of currently used codon partition models and assess their increase in model fit compared to the independent general-time reversible model [<xref ref-type="bibr" rid="B7">7</xref>] and the full codon model of Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>]. Starting from the independent general-time reversible model of evolution, we build these codon partition models in a forward way, continually relaxing specific assumptions concerning evolution in protein-coding regions and calculating the difference in model fit each step of the way. We go on to extend these so-called site-independent codon partition models to context-dependent codon partition models by allowing for the evolution of the third codon position to depend upon the identities of its two immediate flanking positions (i.e. the second codon position of that same codon and the first codon position of the following codon) and by imposing specific Markov chains at the third codon position in the ancestral root sequence. We show that context-dependent evolution at the third codon position is a valuable feature to increase model fit in protein-coding sequences in general and that the properties of four-fold degenerate sites need to be taken into account when building a context-dependent codon partition model.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Data</title><p>We have selected 26 sequences from the available 34 in the work of Karol et al. [<xref ref-type="bibr" rid="B3">3</xref>], for the atpB and rbcL protein-coding sequences. The following sequences were used: <italic>Arabidopsis thaliana, Huperzia spp., Psilotum nudum, Dicksonia Antarctica, Anthoceros spp., Marchantia polymorpha, Chara connivens, Lamprothamnium macropogom, Lychnothamnus barbatus, Nittelopsis obtusa, Nitella opaca, Tolypella prolifera, Coleochaete orbicularis, Coleochaete solute, Coleochaete irregularis, Coleochaete sieminskiana, Onychonema sp., Cosmocladium perissum, Gonatozygon monotaenium, Zygnema peliosporum, Mougeotia sp., Klebsormidium flaccidium, Klebsormidium subtilissimum, Chlamydomonas spp., Nephroselmis olivacea and Cyanophora paradoxa </italic>(as the outgroup). The sequence lengths (for each of the sequences) are 1203bp for the atpB dataset and 1206bp for the rbcL dataset. Our analyses used a fixed consensus tree for these 26 sequences, taken from the tree reported in Karol et al. [<xref ref-type="bibr" rid="B3">3</xref>], as can be seen in Figure <xref ref-type="fig" rid="F1">1</xref> (branch lengths not drawn to scale).</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Fixed consensus tree, based on the original tree inferred by Karol et al. </bold>[<xref ref-type="bibr" rid="B3">3</xref>]<bold>, branch lengths not drawn to scale</bold>.</p></caption><graphic xlink:href="1471-2148-11-145-1"/></fig></sec><sec><title>Site-independent evolutionary models</title><p>Site-independent models of evolution have been the main subject of many phylogenetic studies since the inception of the model of Jukes and Cantor [<xref ref-type="bibr" rid="B12">12</xref>]. Probably one of the most used evolutionary models is the general time-reversible model [<xref ref-type="bibr" rid="B7">7</xref>] with gamma-distributed rate heterogeneity (i.e. among-site rate variation, see e.g. [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]) and a proportion of invariant sites (although it is often argued that invariant sites are included in the category of lowest rates in the gamma distribution describing rate heterogeneity; see e.g. [<xref ref-type="bibr" rid="B9">9</xref>]), often denoted as GTR+&#x00393;+I. For the combined alignment of the four genes (atpB (plastid), rbcL (plastid), nad5 (mitochondrial) and the small subunit (SSU) rRNA gene (nuclear)), Karol et al. [<xref ref-type="bibr" rid="B3">3</xref>] identified this model using a model selection approach as their model of choice for phylogenetic inference, although it is highly unlikely that this is the model that provides the highest fit to the data since more complex models for protein-coding sequences are often not present in popular packages for model selection (see e.g. [<xref ref-type="bibr" rid="B1">1</xref>]). We only consider two truly site-independent models in this paper, i.e. the GTR and the GTR+ &#x00393; model. We have modelled the gamma-distributed rate heterogeneity using Yang's discrete approximation with 4 rate categories [<xref ref-type="bibr" rid="B8">8</xref>].</p></sec><sec><title>Context-dependent (CD) models</title><p>Over the past two decades, various context-dependent models have been developed for analysing non-coding sequence (see [<xref ref-type="bibr" rid="B13">13</xref>] for a review). In previous work [<xref ref-type="bibr" rid="B13">13</xref>], we have developed a context-dependent model that employs a GTR model for each of the 16 possible neighbouring base combinations. We have introduced the notation "GTR16C" for this context-dependent model. A single set of site-independent base frequencies is used for all 16 GTR models, as well as to describe the ancestral root sequence distribution. This model drastically outperforms the independent GTR model, as well as the independent GTR model augmented with the assumption of gamma-distributed rates, for a dataset of primate ancestral repeats.</p><p>Even though protein-coding sequences can in principle not benefit from such models, we have tested the performance of our previously introduced context-dependent model [<xref ref-type="bibr" rid="B13">13</xref>] on both protein-coding datasets presented here. However, the main use of this context-dependent model lies in its introduction to the development of so-called context-dependent codon partition models, which will be discussed later in this paper.</p></sec><sec><title>Full codon models</title><p>Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>] developed one of the first codon-based evolutionary models, i.e. models that have codons as their states, incorporating biologically meaningful factors such as transition/transversion bias, variability of a gene and amino acid differences. Previous models describing the evolution of protein-coding genes in the field of phylogenetics worked either on the mononucleotide level in DNA sequences or on the amino acid level in protein sequences. While nucleotide models have 4 states and amino acid models have 20 states, the codon model of Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>] has 61 states, i.e. the 61 sense codons, as it does not consider the 3 nonsense (stop) codons, given that mutations to or from stop codons can be assumed to drastically affect the structure and function of the protein and therefore will rarely survive.</p><p>Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>] assume that mutations occur independently at the three codon positions and therefore allow only single-nucleotide substitutions to occur. Codons are also assumed to evolve independently from one another. The model multiplies rates of substitution involving a transition by a factor &#x003ba;, which directly affects the ratio of transition and transversion substitutions. To account for selective restraints at the amino acid level, substitution rates are further modified by a multiplicative factor if the two codons code for different amino acids. To do so, the matrix of physicochemical distances between the 20 amino acids, as composed by Grantham [<xref ref-type="bibr" rid="B10">10</xref>], is used. In the implementation of this model, which we denote "GY94", we have used the averages of the observed codon frequencies, as suggested by Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>]. We also allow for among-codon rate variation and denote such a model as "GY94+&#x00393;".</p></sec><sec><title>Codon Partition (CP) models</title><p>Codon partition (CP) models are nucleotide models that accommodate the differences in the evolutionary dynamics at the three codon positions (see e.g. [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B14">14</xref>]). For example, Yang [<xref ref-type="bibr" rid="B14">14</xref>] takes into account the nucleotide frequency bias, the substitution rate bias and the difference in the extent of rate variation among the three codon positions. While Yang [<xref ref-type="bibr" rid="B14">14</xref>] only used the HKY evolutionary model [<xref ref-type="bibr" rid="B15">15</xref>] in his analyses, Shapiro et al. [<xref ref-type="bibr" rid="B1">1</xref>] also included the GTR model. In their comparative study of suitable models for protein-coding sequence, Shapiro et al. [<xref ref-type="bibr" rid="B1">1</xref>] found that for only 2 out of 283 multiple sequence alignments, the GTR+&#x00393;+I model was the best model and for only 1 of them, GTR+ &#x00393; was the model of choice. Likewise, the HKY+I model was only favoured in 1 out of the 283 alignments. As shown by Shapiro et al. [<xref ref-type="bibr" rid="B1">1</xref>], codon partition (CP) models are biologically motivated and are a computationally feasible alternative to codon-based models for the analysis of protein-coding sequences, since the dimensions of the evolutionary matrices do not increase.</p><p>We here describe currently used codon partition models (along with their notation in this paper) but restrict ourselves to those models that use the general time-reversible (GTR) evolutionary model. We do not use nor describe models of invariable sites plus gamma-distributed rates (so-called ''I+ &#x00393;'' models), given the strong correlation between the proportion of invariable sites and the gamma shape parameter (see e.g. [<xref ref-type="bibr" rid="B9">9</xref>]). All the codon partition models discussed in this section assume that the different codon positions evolve independently from one another.</p><p>A first series of models, denoted GTR<sub>112 </sub>and GTR<sub>123</sub>, employ different general time-reversible models depending on codon position. While the GTR<sub>112 </sub>model groups the first and second codon position together and hence uses 2 models (10 free parameters), the GTR<sub>123 </sub>model considers each codon positions separately and hence uses 3 models (15 free parameters). This is also referred to as the accommodation of substitution rate bias.</p><p>These two models can be linked with one common set of base frequencies (3 free parameters) in which case we simply denote them as GTR<sub>112 </sub>and GTR<sub>123</sub>. However, these two models can also be combined with 2 sets of base frequencies (6 free parameters) for the GTR<sub>112 </sub>model and 3 sets of base frequencies (9 free parameters) for the GTR<sub>123 </sub>model and we denote such models with a "+F" notation, i.e. GTR<sub>112</sub>+F<sub>112 </sub>and GTR<sub>123</sub>+F<sub>123</sub>. This is also referred to as the accommodation of nucleotide frequency bias.</p><p>An assumption concerning the evolutionary behaviour of sites in an alignment that typically greatly improves model fit as well as phylogenetic tree reconstruction is that of gamma-distributed rate-heterogeneity, although typically used in non-coding sequence data. In the case of a discrete approximation to rate heterogeneity for all positions, we use the typical "+&#x00393;" notation. Modelling rate heterogeneity requires only one extra parameter. However, given the difference in evolutionary dynamics across codon positions, it may be important to allow for the extent of rate variation to vary across sites. This means using two independent gamma distributions when the first and second codon positions are grouped together and using three independent gamma distributions when the three codon positions are modelled separately. We denote these distributions, which require two and three extra parameters, respectively with a "+&#x00393;<sub>112</sub>" and a "+&#x00393;<sub>123</sub>" notation.</p><p>When simply allowing for different distributions for the rate heterogeneity at different codon positions, it is assumed that the mean rate for each of these distributions is 1. As this may turn out to be unrealistic, so-called rate ratios can be added to allow for different mean rates in the gamma distributions (i.e. to allow for variable mutation rates among the different codon positions). We have used the random-rates approach presented in the work of Burgess and Yang [<xref ref-type="bibr" rid="B16">16</xref>] to accommodate variable mutation rates among codon positions (i.e. the average rate is fixed at 1). In accordance with the work of Shapiro et al. [<xref ref-type="bibr" rid="B1">1</xref>], we use the notations "+CP<sub>112</sub>" and "+CP<sub>123</sub>" to indicate the models with variable mutation rates among codon positions.</p></sec><sec><title>Context-Dependent Codon Partition (CDCP) models</title><p>While the current codon partition (CP) models (see e.g. [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B14">14</xref>]) allow for different evolutionary dynamics at the three codon positions, such models do not incorporate dependencies between the different codon partitions (i.e. each codon position is still assumed to evolve independently). Allowing for such dependencies is a particular strength of full codon models. In this paper, we provide a series of possible extensions for current codon partition models, based on the assumption that codon positions do not evolve independently from one another. As stated in the introduction, our context-dependent modelling assumptions are inspired by the work of Morton [<xref ref-type="bibr" rid="B11">11</xref>], who detected a significant correlation between the number of transversions at four-fold degenerate sites and the A+T content of the two immediate flanking bases.</p><p>As a first attempt, we assume context-dependent evolution of the third codon position on its two immediate flanking bases (i.e. the second codon position of the same codon and the first codon position of the succeeding codon). The first and second codon positions however are still assumed to evolve independently from one another. We model this dependence by assuming that evolution at the third codon position occurs according to our full context-dependent GTR16C model [<xref ref-type="bibr" rid="B13">13</xref>]. This means that for the third codon position, 16 GTR models (but each employing the same (single) set of base frequencies) will be estimated, one for each neighbouring base combination, resulting in 80 free evolutionary parameters to be estimated for the third codon position (compared to 5 free evolutionary parameters for the first codon position and the second codon position). We use the notation "+CD<sub>16</sub>" for this assumption.</p><p>One of the main conclusions of the study of Morton [<xref ref-type="bibr" rid="B11">11</xref>] is that the number of transversions at the third codon position are correlated with the A+T content of its two immediate flanking bases. To incorporate this finding, we have adapted our full context-dependent model (GTR16C; see [<xref ref-type="bibr" rid="B13">13</xref>]) to only combine 3 GTR models (or 15 free parameters) for the third codon position: 1 for an A+T content of 0 (i.e. none of the two immediate flanking bases is either A or T), 1 for an A+T content of 1 (i.e. exactly one of the two immediate flanking bases is either A or T) and 1 for an A+T content of 2 (i.e. both immediate flanking bases are either A or T). We use the notation "+CD<sub>3</sub>" for this assumption. Note that both the first and second codon positions are still allowed to evolve independently.</p></sec><sec><title>Four-fold degenerate sites</title><p>A position of a codon is said to be a four-fold degenerate site if any nucleotide at this position specifies the same amino acid. For example, the third position of the glycine codons (GGA, GGG, GGC, GGU) is a four-fold degenerate site, because all nucleotide substitutions at this site are synonymous, i.e. they do not change the amino acid. Only the third positions of some codons may be fourfold degenerate. The following amino acids have four-fold degenerate codon positions: alanine (GCX), arginine (CGX), glycine (GGX), leucine (CUX), praline (CCX), threonine (ACX), serine (UCX) and valine (GUX).</p><p>Here, we expand the context-dependent codon partition model introduced in the previous section in that the context-dependent model at the third codon position is only used for the four-fold degenerate sites, as identified at the start of each branch. Non four-fold degenerate sites are assumed to evolve according to a separate site-independent general time-reversible model, which shares the same (single) set of base frequencies as the context-dependent model at the four-fold degenerate sites. When assuming the full context-dependent model at the third codon position, we denote this model "+FF<sub>16</sub>"; when using the context-dependent model at the third codon position that is aimed at modelling a correlation to the A+T context of its two immediate flanking bases, we denote the model as "+FF<sub>3</sub>".</p></sec><sec><title>Ancestral root sequence distribution</title><p>In previous work on context-dependent models for non-coding sequences, we have extensively discussed the importance of an adequate ancestral root sequence distribution to estimate the evolutionary parameters of context-dependent models [<xref ref-type="bibr" rid="B17">17</xref>]. Indeed, while the context-dependent models presented in the two previous sections impose a dependency scheme at the third codon position across the underlying tree, it does not in any way impose a dependency pattern at the ancestral root of the underlying phylogenetic tree. To ensure a dependency scheme across the entire underlying phylogenetic tree, we therefore allow for different ancestral root distributions for the third codon position.</p><p>The standard approach would be to use the values of the base frequencies describing the contents of the third codon position as the prior probability for the states of the third codon position (see e.g. [<xref ref-type="bibr" rid="B18">18</xref>]), which assumes independence at the ancestral root sequence. An approach which we have shown to be practical when modelling context-dependent evolution in non-coding sequences [<xref ref-type="bibr" rid="B17">17</xref>], is to assume a zero-order Markov chain (i.e. a separate set of independent base frequencies <italic>&#x003c0;</italic><sub><italic>ROOT </italic></sub>= {<italic>&#x003c0;</italic><sub><italic>A</italic></sub>, <italic>&#x003c0;</italic><sub><italic>C</italic></sub>, <italic>&#x003c0;</italic><sub><italic>G</italic></sub>, <italic>&#x003c0;</italic><sub><italic>T</italic></sub>}) to describe the ancestral root distribution at the third codon position. This approach hence requires merely 3 additional free parameters.</p><p>An extension of this approach is to use a first-order Markov chain to allow for dependence of the third codon position on the second codon position (of the same codon) in the ancestral root sequence, which requires four independent sets of base frequencies <italic>&#x003c0;</italic><sub><italic>ROOT </italic></sub>= {<italic>&#x003c0;</italic><sub><italic>X|A</italic></sub>, <italic>&#x003c0;</italic><sub><italic>X|C</italic></sub>, <italic>&#x003c0;</italic><sub><italic>X|G</italic></sub>, <italic>&#x003c0;</italic><sub><italic>X|T</italic></sub>}, with <italic>X </italic>&#x02208; {<italic>A,C,G,T</italic>} the identity of the site at the second codon position of the same codon. One could also choose to model a first-order Markov chain in the opposite direction, i.e. where the identity of the third codon position would depend upon the identity of the first codon position of the succeeding codon. However, it is realistic to expect that this approach will be less optimal in terms of model fit, so we did not attempt to include this dependency scheme. Note that our notation for the distribution at the root sequence differs from the typical notation for conditional probabilities in that we put the conditional part before the 'pipe' symbol ('|').</p><p>A final approach to model context-dependence at the third codon position in the ancestral root sequence is to allow its identity to depend upon the identity of its two immediate flanking bases, i.e. the identity of the second codon position of the same codon and the identity of the first codon position of the succeeding codon. We model this "second-order" dependence through 16 sets of base frequencies <italic>&#x003c0;</italic><sub><italic>ROOT </italic></sub>= {<italic>&#x003c0;</italic><sub><italic>X|A|Y</italic></sub>, <italic>&#x003c0;</italic><sub><italic>X|C|Y</italic></sub>, <italic>&#x003c0;</italic><sub><italic>X|G|Y</italic></sub>, <italic>&#x003c0;</italic><sub><italic>X|T|Y</italic></sub>}, with <italic>X </italic>&#x02208; {<italic>A, C, G, T</italic>} the identity of the site at the second codon position of the same codon and <italic>Y </italic>&#x02208; {<italic>A, C, G, T</italic>} the identity of the site at the first codon position of the succeeding codon.</p></sec><sec><title>Bayesian Markov Chain Monte Carlo using data augmentation</title><p>Bayesian inference of phylogeny is based on a quantity called the posterior probability function of a tree, in the same way as maximum-likelihood inference is based on the likelihood function. While the posterior probability is generally tedious to calculate, simulating from it is relatively easy through the use of Markov chain Monte Carlo (MCMC) methods ([<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>]). Relaxing the assumption of independent evolution leads to more parameter-rich evolutionary models and computational difficulties, which we handle via a data augmentation scheme [<xref ref-type="bibr" rid="B21">21</xref>]. As previously discussed [<xref ref-type="bibr" rid="B22">22</xref>], consistency problems may arise with such high-dimensional models, along with potential computational burdens. In view of this, a model-selection approach should be used that penalizes the addition of extra parameters unless there is a sufficiently impressive improvement in fit between model and data [<xref ref-type="bibr" rid="B22">22</xref>]. To compare the different assumptions concerning the root distribution, we have calculated (log) Bayes Factors [<xref ref-type="bibr" rid="B23">23</xref>]. Log Bayes Factors are typically divided into 4 categories depending on their value: from 0 to 1, indicating nothing worth reporting; from 1 to 3, indicating positive evidence of one model over the other; from 3 to 5, indicating strong evidence of one model over the other; and larger than 5, indicating very strong evidence of one model over the other. We have chosen to calculate Bayes Factors using thermodynamic integration [<xref ref-type="bibr" rid="B24">24</xref>], since the traditional harmonic mean estimator of the marginal likelihood systematically favours parameter-rich models and is hence unfit to compare these complex context-dependent models. A detailed discussion of the data augmentation approach in our proposed Bayesian Markov chain Monte Carlo approach and in the thermodynamic integration framework for model comparison can be found in previous work [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B25">25</xref>].</p></sec><sec><title>Prior Distributions</title><p>Let <italic>T </italic>be the set of branch lengths with <italic>t<sub>b </sub></italic>(<italic>t<sub>b</sub></italic>&#x02265;0) one arbitrary branch length and &#x003bc; a hyperparameter in the prior for <italic>t<sub>b </sub></italic>in <italic>T </italic>(see e.g. [<xref ref-type="bibr" rid="B26">26</xref>]). The following prior distributions <italic>q </italic>(&#x000b7;) are chosen for our analysis, with &#x00393;(&#x000b7;) the Gamma function. Dirichlet priors (which are uninformative priors) assign densities to groups of parameters that measure proportions (i.e., parameters that must sum to 1). For each set of base frequencies (which we here denote <italic>&#x003c0;</italic><sub>1,2,3</sub>) that describes the nucleotide composition of a codon position (and also the ancestral root distribution), the following prior distribution is assumed:<disp-formula><graphic xlink:href="1471-2148-11-145-i1.gif"/></disp-formula></p><p>For each set of model frequencies of which the ancestral root sequence is composed, the following prior distribution is assumed:<disp-formula><graphic xlink:href="1471-2148-11-145-i2.gif"/></disp-formula></p><p>As mentioned earlier, we have used the random-rates approach presented in the work of Burgess and Yang [<xref ref-type="bibr" rid="B16">16</xref>] to accommodate variable mutation rates among codon positions. Let the rate at codon position <italic>i </italic>be <italic>r<sub>i</sub></italic>, with <italic>i </italic>= 1,2,3. To avoid overparameterization, the average rate is fixed at one: <inline-formula><inline-graphic xlink:href="1471-2148-11-145-i3.gif"/></inline-formula> and a Dirichlet prior is assigned on the variables <inline-formula><inline-graphic xlink:href="1471-2148-11-145-i4.gif"/></inline-formula>. For additional information on this prior assignment, we refer to the work of Burgess and Yang [<xref ref-type="bibr" rid="B16">16</xref>].</p><p>For each codon position, the parameter <italic>&#x003b1;<sub>i</sub></italic>, with <italic>i </italic>= 1,2,3, describing the among-site rate variation gamma-distribution at that codon position, is assumed to follow a uniformly distributed prior between 0 and 50.</p><p>For the model parameters of each context (i.e. neighbouring base combination) independently, the following prior distribution is assumed (see e.g. [<xref ref-type="bibr" rid="B27">27</xref>]):<disp-formula><graphic xlink:href="1471-2148-11-145-i5.gif"/></disp-formula></p><p>Further, branch lengths are assumed i.i.d. given <italic>&#x003bc;</italic>:<disp-formula><graphic xlink:href="1471-2148-11-145-i6.gif"/></disp-formula></p><p>and<disp-formula><graphic xlink:href="1471-2148-11-145-i7.gif"/></disp-formula></p></sec></sec><sec><title>Results</title><sec><title>atpB dataset</title><p>Using the model-switch thermodynamic integration scheme, we have compared all site-independent, codon partition and context-dependent codon partition model to the independent general time-reversible model (GTR). Figure <xref ref-type="fig" rid="F2">2</xref> shows all calculated bidirectional mean log Bayes Factors for those evolutionary models that group first and second codon positions, while Figure <xref ref-type="fig" rid="F3">3</xref> shows the results for those evolutionary models that consider each codon position separately (annealing and melting thermodynamic integration results can be found in Tables S1, S2 and S3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The presented models are constructed from the bottom up, i.e. from left to right in Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref>, each time an additional evolutionary assumption is relaxed with respect to the models (i.e. additional parameters are added). For matters of comparison, the left-hand side of Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> show the performances of 4 models that can be used in the analysis of non-coding sequences: GTR (black line; mean log Bayes Factor of 0), GTR+&#x00393; (white bar; using 4 discrete rate categories; mean log Bayes Factor of 1398.01); GTR16C (yellow bar; mean log Bayes Factor of 275.08); and GTR16C+&#x00393; (orange bar; mean log Bayes Factor of 1585.80).</p><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>atpB dataset: Comparison of all models presented in this paper to the GTR model, when grouping the first and second codon positions together</bold>. The performance of "traditional" codon partition models (up to the dotted horizontal line) can be improved significantly by assuming context-dependent evolution at the third codon position. As can be seen from this figure, such context-dependent codon partition models systematically outperform the (independent) codon partition models in terms of model fit.</p></caption><graphic xlink:href="1471-2148-11-145-2"/></fig><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>atpB dataset: Comparison of all models presented in this paper to the GTR model, when treating each codon position separately</bold>. The performance of "traditional" codon partition models (up to the dotted horizontal line) can be improved significantly by assuming context-dependent evolution at the third codon position. As is confirmed in this figure, such context-dependent codon partition models systematically outperform the (independent) codon partition models in terms of model fit. Further, the models that assume that first and second codon positions evolve according to a separate evolutionary model (in this figure) systematically outperform those models that treat first and second codon positions identically (from an evolutionary perspective).</p></caption><graphic xlink:href="1471-2148-11-145-3"/></fig><p>The overall trend in Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> is identical, albeit that the results presented in Figure <xref ref-type="fig" rid="F3">3</xref> (where each codon position is treated separately) systematically outperform those presented in Figure <xref ref-type="fig" rid="F2">2</xref> (where the first and second codon positions are grouped together). The basic model in Figure <xref ref-type="fig" rid="F2">2</xref> is hence the GTR<sub>112 </sub>model, while the basic model in Figure <xref ref-type="fig" rid="F3">3</xref> is the GTR<sub>123 </sub>model. To start the various model comparisons, both the GTR<sub>112 </sub>and GTR<sub>123 </sub>models are augmented with the "+CD<sub>3</sub>", "+CD<sub>16</sub>", "+FF<sub>3</sub>" and "+FF<sub>16</sub>" context-dependent assumptions. In both Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> it can clearly be seen that the context-dependent substitution patterns for the third codon position increase model fit substantially, even without accommodating additional evolutionary effects such as nucleotide frequency bias or assuming among-site rate variation for each codon position (see Tables S1, S2 and S3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for numerical results). These context-dependent codon partition models continue to outperform the traditional codon partition models with the inclusion of all the evolutionary assumptions discussed in the Methods section.</p><p>Allowing for among-site variation ("+&#x00393;" in both Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref>; using 4 discrete rate categories, as is conventional when analyzing non-coding sequences) yields the largest increase in model fit. As it makes more sense in coding sequences to assume a specific pattern of among-site rate variation for either the first and second codon positions grouped together ("+&#x00393;<sub>112</sub>" in Figure <xref ref-type="fig" rid="F2">2</xref>) or for each codon position separately ("+&#x00393;<sub>123</sub>" in Figure <xref ref-type="fig" rid="F3">3</xref>), the corresponding models clearly outperform a model which imposes 1 general pattern of among-site rate variation for all sites. To relax the restriction that each codon position has a mean evolutionary rate of 1.0, which is deemed unrealistic, this is usually accompanied by a different mean evolutionary rate per codon position ("+CP<sub>112</sub>" in Figure <xref ref-type="fig" rid="F2">2</xref> and "+CP<sub>123</sub>" in Figure <xref ref-type="fig" rid="F3">3</xref>).</p><p>Given that up to this point, one single set of base frequencies has been used for the different codon positions, we have relaxed this assumption and have modelled the so-called nucleotide frequency bias ("+F<sub>112</sub>" in Figure <xref ref-type="fig" rid="F2">2</xref> and "+F<sub>123</sub>" in Figure <xref ref-type="fig" rid="F3">3</xref>). For both the GTR<sub>112 </sub>and GTR<sub>123 </sub>models without the assumption of context-dependence for the third codon position, this latest inclusion marks the optimal model fit as presented in the literature. We have marked the corresponding increase in model fit in both Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> by a dotted horizontal line. Assuming context-dependence for all third codon positions on the A+T context of the two immediate flanking bases (GTR<sub>112</sub>+&#x00393;<sub>112</sub>+CP<sub>112</sub>+F<sub>112</sub>+CD<sub>3 </sub>and GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+CD<sub>3</sub>) does not yield an increase over its independence counterpart (GTR<sub>112</sub>+&#x00393;<sub>112</sub>+CP<sub>112</sub>+F<sub>112 </sub>and GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>). All other dependency patterns at the third codon position have however resulted in increases vis-&#x000e0;-vis the current state-of-the-art codon partition models, with the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>3 </sub>model yielding the largest increase in model fit.</p><p>Of the different ancestral root distributions proposed to model a dependency scheme at the third codon position, the first-order Markov chain (i.e., model GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>3</sub>+3F) offers the largest improvement in model fit across the different model comparisons, followed by the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model. The same pattern can be seen when grouping first and second codon positions together, but these models are consistently outperformed by those models that treat each codon position separately.</p><p>Figure <xref ref-type="fig" rid="F3">3</xref> also shows the performance of the full codon model of Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>]. The GY94 model yields an increase in model fit vis-&#x000e0;-vis the GTR model of 3134.49 log units (annealing 95% CI: [3096.16; 3130.80]; melting 95% CI: [3136.83; 3174.19]) and the GY94+&#x00393; model (annealing 95% CI: [3277.70; 3331.63]; melting 95% CI: [3416.64; 3472.83]) an increase of 3374.70 log units. We have included this result for the sake of comparison, as these models mimic full codon models. We thus find that the proposed context-dependent codon partition models improve upon the existing codon partition models and partially close the gap with full codon models. Note, however, that this is not the main point of such a comparison, given that the presented models include dependencies across the codon boundaries and are hence not exclusively aimed towards mimicking codon models more closely.</p><p>As we have shown in previous work [<xref ref-type="bibr" rid="B25">25</xref>], parameter clustering may drastically increase model fit of a given context-dependent evolutionary model. While this is not the aim of this study, it is thus quite realistic that clustering several parameters together will result in the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model being the optimal codon partition model for the atpB dataset. This is why we go on to discuss the parameter estimates for this model. The parameter estimates shown in Figure <xref ref-type="fig" rid="F4">4</xref> support the model building approach we have taken in this paper. For instance, the evolutionary estimates for those third codon position that are four-fold degenerate sites, are clearly different from those of the first two codon positions, which are clearly different from one another as well (for example, the rGC, rCG and rTC estimates), justifying the use of a separate evolutionary model for all three codon positions. Particularly interesting is the increased rCT substitution rate at those third codon positions that are not four-fold degenerate sites.</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>atpB dataset: Estimated substitution patterns for the independent evolutionary models at first, second and third codon positions and the context-dependent evolutionary model at the third codon position for the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model</bold>. At the left of this figure, i.e. the first two columns, the independent model estimates for first (1<sup>st </sup>CP), second (2<sup>nd </sup>CP) and third (3<sup>rd </sup>CP) codon positions are shown. At the right of the figure (columns 3 through 10), the context-dependent estimates for the third codon position are shown for each evolutionary context, i.e. each neighbouring base combination. In the figure, the substitution parameter types (i.e. rAG, rAC, ..., rTC) each have a unique colour, as indicated in the legend panel within the figure, and the same colour is used for every model (context-dependent or not).</p></caption><graphic xlink:href="1471-2148-11-145-4"/></fig><p>The context-dependent substitution rates, which are grouped by the identity of the left neighbouring base, form the most interesting aspect of Figure <xref ref-type="fig" rid="F4">4</xref>. Note that, given the small size of the (single-gene) alignment and the multitude of substitution rates to be estimated, the 95% credibility intervals are quite wide. Further, it is important to assess whether there are bidirectional dependencies on the third codon position, i.e. whether there is an influence of the identities of both left and right neighbouring bases on the substitution rate. We discuss the context-dependent substitution rates for the four-fold degenerate sites, as grouped by the identity of their left neighbouring base, in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Important to notice is that the relationship between these substitution rates and the immediate neighbouring bases extends well beyond an influence of the A+T context of those bases, as proposed by Morton [<xref ref-type="bibr" rid="B11">11</xref>].</p><p>Table <xref ref-type="table" rid="T1">1</xref> shows drastic differences in the nucleotide frequency estimates for the three codon positions, illustrating the importance of not grouping first and second codon positions together, as shown by the calculated (log) Bayes Factors in Tables S1 through S3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Further, there are clearly large differences in the degree of among-site rate variation across codon positions. All three gamma distributions are L-shaped, meaning that for each codon position, most sites have very low substitution rates or are virtually invariable, while a few sites exist with very high rates [<xref ref-type="bibr" rid="B8">8</xref>]. While the first codon positions evolve on average twice as fast as the second codon positions, the mean rate for the third codon position is drastically elevated compared to the first and second codon positions, as indicated by the estimates for the relative rates in Table <xref ref-type="table" rid="T1">1</xref>.</p><table-wrap id="T1" position="float"><label>Table 1</label><caption><p>atpB dataset: estimates per codon position for the nucleotide frequencies, among-site rate variation distribution and relative rates (for the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model).</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="center" colspan="4">Frequencies</th><th/><th/></tr></thead><tbody><tr><td align="center"><bold>CP</bold></td><td align="center"><bold>A</bold></td><td align="center"><bold>C</bold></td><td align="center"><bold>G</bold></td><td align="center"><bold>T</bold></td><td align="center"><inline-formula><inline-graphic xlink:href="1471-2148-11-145-i8.gif"/></inline-formula></td><td align="center"><bold>CP<sub>123</sub></bold></td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="center">1</td><td align="center">0.2396<break/>[0.21; 0.28]</td><td align="center">0.2216<break/>[0.19; 0.26]</td><td align="center">0.3717<break/>[0.33; 0.42]</td><td align="center">0.1671<break/>[0.14; 0.20]</td><td align="center">0.1579<break/>[0.11; 0.24]</td><td align="center">0.1066<break/>[0.08; 0.14]</td></tr><tr><td align="center">2</td><td align="center">0.2804<break/>[0.24; 0.33]</td><td align="center">0.2298<break/>[0.19; 0.27]</td><td align="center">0.1656<break/>[0.13; 0.20]</td><td align="center">0.3242<break/>[0.28; 0.38]</td><td align="center">0.0946<break/>[0.01; 0.15]</td><td align="center">0.0512<break/>[0.04; 0.07]</td></tr><tr><td align="center">3</td><td align="center">0.3784<break/>[0.35; 0.41]</td><td align="center">0.0875<break/>[0.08; 0.10]</td><td align="center">0.0707<break/>[0.06; 0.08]</td><td align="center">0.4634<break/>[0.43; 0.50]</td><td align="center">0.8716<break/>[0.73; 1.04]</td><td align="center">2.8422<break/>[2.80; 2.88]</td></tr></tbody></table><table-wrap-foot><p>Shown are mean estimates of 100.000 MCMC iterations, discarding the first 20.000 iterations as the burn-in, and the corresponding 95% credibility intervals. The values in the table clearly illustrate the different substitution dynamics at the three codon positions.</p></table-wrap-foot></table-wrap><p>Table <xref ref-type="table" rid="T2">2</xref> shows the estimates of the first-order Markov chain imposed on the third codon position in the ancestral root sequence for the atpB dataset. While the mean values of the estimates reveal large differences in the first-order estimates, they are often accompanied by very wide 95% credibility intervals, which is why this ancestral root distribution at the third codon position offers only a small improvement on average over the other assumptions (zero-order Markov chain and dependence on both neighbouring bases; see Table S3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p><table-wrap id="T2" position="float"><label>Table 2</label><caption><p>atpB dataset: estimates for the first-order Markov chain distribution at the ancestral root sequence (for the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model).</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="center" colspan="4">Root</th></tr></thead><tbody><tr><td align="center"><bold>X</bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|A</sub></italic></bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|C</sub></italic></bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|G</sub></italic></bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|T</sub></italic></bold></td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="center">A</td><td align="center">0.5049<break/>[0.38; 0.61]</td><td align="center">0.4089<break/>[0.28; 0.52]</td><td align="center">0.0382<break/>[0.00; 0.13]</td><td align="center">0.0480<break/>[0.00; 0.16]</td></tr><tr><td align="center">C</td><td align="center">0.1018<break/>[0.00; 0.31]</td><td align="center">0.2481<break/>[0.01; 0.75]</td><td align="center">0.1993<break/>[0.01; 0.55]</td><td align="center">0.4507<break/>[0.06; 0.79]</td></tr><tr><td align="center">G</td><td align="center">0.0402<break/>[0.00; 0.15]</td><td align="center">0.1610<break/>[0.00; 0.52]</td><td align="center">0.1088<break/>[0.01; 0.40]</td><td align="center">0.6899<break/>[0.16; 0.94]</td></tr><tr><td align="center">T</td><td align="center">0.1010<break/>[0.01; 0.25]</td><td align="center">0.3925<break/>[0.22; 0.54]</td><td align="center">0.4490<break/>[0.29; 0.59]</td><td align="center">0.0575<break/>[0.00; 0.20]</td></tr></tbody></table><table-wrap-foot><p>Shown are mean estimates of 100.000 MCMC iterations, discarding the first 20.000 iterations as the burn-in, and the corresponding 95% credibility intervals. Despite the wide 95% credibility intervals, the estimates show why such a first-order dependence is useful.</p></table-wrap-foot></table-wrap></sec><sec><title>rbcL dataset</title><p>As for the atpB dataset, we have compared all codon partition and context-dependent codon partition model to the independent general time-reversible model using the model-switch thermodynamic integration scheme. Figure <xref ref-type="fig" rid="F5">5</xref> shows all the calculated bidirectional mean log Bayes Factors for those evolutionary models that group first and second codon positions, while Figure <xref ref-type="fig" rid="F6">6</xref> shows the results for those evolutionary models that consider each codon position separately (annealing and melting thermodynamic integration results can be found in Tables S4, S5 and S6 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). For matters of comparison, the left-hand side of Figures <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref> show the performances of 4 models that can be used in the analysis of non-coding sequences: GTR (black line; mean log Bayes Factor of 0), GTR+&#x00393; (white bar; using 4 discrete rate categories; mean log Bayes Factor of 1106.06); GTR16C (yellow bar; mean log Bayes Factor of 323.17); and GTR16C+&#x00393; (orange bar; mean log Bayes Factor of 1381.77).</p><fig id="F5" position="float"><label>Figure 5</label><caption><p><bold>rbcL dataset: Comparison of all models presented in this paper to the GTR model, when grouping the first and second codon positions together</bold>. The performance of "traditional" codon partition models (up to the dotted horizontal line) can be improved significantly by assuming context-dependent evolution at the third codon position. As can be seen from this figure, such context-dependent codon partition models systematically outperform the (independent) codon partition models in terms of model fit.</p></caption><graphic xlink:href="1471-2148-11-145-5"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><p><bold>rbcL dataset: Comparison of all models presented in this paper to the GTR model, when treating each codon position separately</bold>. The performance of "traditional" codon partition models (up to the dotted horizontal line) can be improved significantly by assuming context-dependent evolution at the third codon position. As is confirmed in this figure, such context-dependent codon partition models systematically outperform the (independent) codon partition models in terms of model fit. Further, the models that assume that first and second codon positions evolve according to a separately evolutionary model (in this figure) systematically outperform those models that treat first and second codon positions identically (from an evolutionary perspective).</p></caption><graphic xlink:href="1471-2148-11-145-6"/></fig><p>The overall trend in Figures <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref> is identical to that in Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref>. Comparing Tables S1 through S6 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> reveals that not only the hierarchy of the models is identical, but also that the exact same model is preferred for the rbcL dataset as for the atpB dataset. However, despite the fact that the rbcL alignment is only 3 sites shorter than the atpB alignment (i.e. 0.25% shorter), there are large differences in the calculated log Bayes Factors across the models evaluated. For example, the log Bayes Factor for the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model compared to the GTR model for the atpB datasets is 313 log units higher than the corresponding log Bayes Factor for the rbcL dataset. Hence, as was the case for the atpB dataset, it can be seen from Figures <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref> that the context-dependent substitution patterns for the third codon position increase model fit substantially, even without accommodating additional evolutionary effects such as nucleotide frequency bias or among-site rate variation for each codon position (see Tables S4, S5 and S6 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for numerical results) and that these context-dependent codon partition models outperform traditional codon partition models.</p><p>Figure <xref ref-type="fig" rid="F6">6</xref> also shows the performance of the full codon model of Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>], which outperforms all other models as was the case for the atpB dataset. The GY94 model yields an increase in model fit vis-&#x000e0;-vis the GTR model of 3134.49 log units (annealing 95% CI: [3309.51; 3339.88]; melting 95% CI: [3349.88; 3382.22]) and the GY94+&#x00393; model (annealing 95% CI: [3356.12; 3408.43]; melting 95% CI: [3459.73; 3505.79]) an increase of 3374.70 log units.</p><p>The parameter estimates for the optimal GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model, which are shown in Figure <xref ref-type="fig" rid="F7">7</xref>, are discussed in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. Important to notice is once again that the relationship between these substitution rates and the immediate neighbouring bases extends well beyond an influence of the A+T context of those bases, as proposed by Morton [<xref ref-type="bibr" rid="B11">11</xref>]. In short, compared to Figure <xref ref-type="fig" rid="F4">4</xref> which contains the context-dependent estimates for the atpB dataset, it can be concluded from Figure <xref ref-type="fig" rid="F7">7</xref> that the overall rCT substitution rate is drastically lower in the rbcL dataset across all the neighbouring base combinations (as was the case for the non four-fold degenerate sites); the 95% credibility intervals are much smaller. Moreover, the rCT estimates do not differ all that much depending on the neighbouring base combinations, as opposed to the atpB dataset. Further, the rCA and rCG substitution rates are also lower than in the atpB dataset and have much smaller 95% credibility intervals as well. On the other hand, the 95% credibility intervals for the rAG and rAT estimates are larger than in the atpB dataset. In short, the main differences in terms of the context-dependent substitution rates at the four-fold degenerate sites can be found in the rGC, rGT and rGA parameters.</p><fig id="F7" position="float"><label>Figure 7</label><caption><p><bold>rbcL dataset: Estimated substitution patterns for the independent evolutionary models at first, second and third codon positions and the context-dependent evolutionary model at the third codon position for the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model</bold>. At the left of this figure, i.e. the first two columns, the independent model estimates for first (1<sup>st </sup>CP), second (2<sup>nd </sup>CP) and third (3<sup>rd </sup>CP) codon positions are shown. At the right of the figure (columns 3 through 10), the context-dependent estimates for the third codon position are shown for each evolutionary context, i.e. each neighbouring base combination. In the figure, the substitution parameter types (i.e. rAG, rAC, ..., rTC) each have a unique colour, as indicated in the legend panel within the figure, and the same colour is used for every model (context-dependent or not).</p></caption><graphic xlink:href="1471-2148-11-145-7"/></fig><p>The observation that the overall substitution behaviour as well as the context-dependent substitution patterns at the fourfold degenerate sites differs between the atpB and the rbcL genes is not surprising as Morton [<xref ref-type="bibr" rid="B11">11</xref>] already reported that rbcL is the exceptional case in the chloroplast genes in terms of the relationship between context and substitution bias. As a possible explanation for this observation, Morton [<xref ref-type="bibr" rid="B11">11</xref>] suggested that a more complex context dependency exists than the relationship between substitution bias and A+T context that the author has studied. However, given that we have estimated more complex context-dependent substitution patterns at the fourfold degenerate sites, in that we don't refrain ourselves from only distinguishing between transitions and transversions, we still observe clearly different substitution behaviour between the two datasets. Additional datasets, such as the ndhF, psbA, matK, atpA, ..., genes, should be studied to further clarify the substitution patterns in the chloroplast genes. Unfortunately, these genes have not yet been sequenced for the majority of the organisms used in this paper.</p><p>As for the atpB dataset, Table <xref ref-type="table" rid="T3">3</xref> shows drastic differences in the nucleotide frequency estimates for the three codon positions, which is reflected in the higher log Bayes Factors for those models that treat all three codon positions separately (see Tables S4 through S6 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). A notable difference between the two datasets is the underrepresentation of cytosine at the third codon position in the atpB dataset, which is not the case in the rbcL dataset. Further, while the among-site rate distribution parameters for the first and second codon positions are quite similar for both datasets, this is not the case for the third codon position, where the gamma distribution parameter is three times higher for the rbcL dataset. Hence, only the gamma distributions for the first and second codon positions are L-shaped, meaning that for each codon position, most sites have very low substitution rates or are virtually invariable, while a few sites exist with very high rates. The gamma distribution for the third codon position is bell-shaped, meaning that most sites have intermediate rates while few sites have very low or very high rates [<xref ref-type="bibr" rid="B8">8</xref>]. The relative rate estimates for the rbcL dataset also show some differences compared to the estimates of the atpB dataset. The mean rates of the first and second codon positions are two to three times higher than in the atpB dataset, with the mean rate at the third codon position dropping about 10 percent.</p><table-wrap id="T3" position="float"><label>Table 3</label><caption><p>rbcL dataset: estimates per codon position for the nucleotide frequencies, among-site rate variation distribution and relative rates (for the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model).</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="center" colspan="4">Frequencies</th><th/><th/></tr></thead><tbody><tr><td align="center"><bold>CP</bold></td><td align="center"><bold>A</bold></td><td align="center"><bold>C</bold></td><td align="center"><bold>G</bold></td><td align="center"><bold>T</bold></td><td align="center"><inline-formula><inline-graphic xlink:href="1471-2148-11-145-i8.gif"/></inline-formula></td><td align="center"><bold>CP<sub>123</sub></bold></td></tr><tr><td colspan="7"><hr/></td></tr><tr><td align="center">1</td><td align="center">0.2202<break/>[0.19; 0.26]</td><td align="center">0.2484<break/>[0.22; 0.28]</td><td align="center">0.3536<break/>[0.31; 0.40]</td><td align="center">0.1778<break/>[0.15; 0.21]</td><td align="center">0.1948<break/>[0.15; 0.26]</td><td align="center">0.2802<break/>[0.23; 0.34]</td></tr><tr><td align="center">2</td><td align="center">0.2712<break/>[0.22; 0.32]</td><td align="center">0.2558<break/>[0.20; 0.31]</td><td align="center">0.2071<break/>[0.16; 0.26]</td><td align="center">0.2660<break/>[0.22; 0.32]</td><td align="center">0.0465<break/>[0.00; 0.11]</td><td align="center">0.1212<break/>[0.09; 0.16]</td></tr><tr><td align="center">3</td><td align="center">0.2200<break/>[0.18; 0.26]</td><td align="center">0.2152<break/>[0.19; 0.25]</td><td align="center">0.0634<break/>[0.05; 0.08]</td><td align="center">0.5014<break/>[0.46; 0.54]</td><td align="center">2.6956<break/>[1.92; 3.84]</td><td align="center">2.5986<break/>[2.53; 2.66]</td></tr></tbody></table><table-wrap-foot><p>Shown are mean estimates of 100.000 MCMC iterations, discarding the first 20.000 iterations as the burn-in, and the corresponding 95% credibility intervals. The values in the table clearly illustrate the different substitution dynamics at the three codon positions. There are many differences with the estimates of the atpB dataset, shown in Table 1. The most notable differences are the among-site rate variation distribution parameter and the nucleotide frequencies for the third codon position.</p></table-wrap-foot></table-wrap><p>Table <xref ref-type="table" rid="T4">4</xref> shows the estimates of the first-order Markov chain imposed on the third codon position in the ancestral root sequence for the rbcL dataset. The mean values of the estimates are once again accompanied by wide 95% credibility intervals, although not to the extent of the atpB dataset. While the distribution of frequencies is quite similar when the preceding base is adenine, for the other preceding bases this isn't the case, with the largest difference occurring when the preceding base is cytosine.</p><table-wrap id="T4" position="float"><label>Table 4</label><caption><p>rbcL dataset: estimates for the first-order Markov chain distribution at the ancestral root sequence (for the GTR<sub>123</sub>+&#x00393;<sub>123</sub>+CP<sub>123</sub>+F<sub>123</sub>+FF<sub>16</sub>+3F model).</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="center" colspan="4">Root</th></tr></thead><tbody><tr><td align="center"><bold>X</bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|A</sub></italic></bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|C</sub></italic></bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|G</sub></italic></bold></td><td align="center"><bold><italic>&#x003c0;<sub>X|T</sub></italic></bold></td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="center">A</td><td align="center">0.4225<break/>[0.33; 0.51]</td><td align="center">0.5464<break/>[0.46; 0.64]</td><td align="center">0.0159<break/>[0.00; 0.06]</td><td align="center">0.0151<break/>[0.00; 0.06]</td></tr><tr><td align="center">C</td><td align="center">0.4454<break/>[0.23; 0.69]</td><td align="center">0.0111<break/>[0.00; 0.04]</td><td align="center">0.0364<break/>[0.00; 0.11]</td><td align="center">0.5071<break/>[0.26; 0.73]</td></tr><tr><td align="center">G</td><td align="center">0.0164<break/>[0.00; 0.07]</td><td align="center">0.0147<break/>[0.00; 0.06]</td><td align="center">0.1294<break/>[0.05; 0.25]</td><td align="center">0.8395<break/>[0.71; 0.93]</td></tr><tr><td align="center">T</td><td align="center">0.3319<break/>[0.17; 0.48]</td><td align="center">0.2020<break/>[0.11; 0.31]</td><td align="center">0.2660<break/>[0.14; 0.43]</td><td align="center">0.2001<break/>[0.07; 0.34]</td></tr></tbody></table><table-wrap-foot><p>Shown are mean estimates of 100.000 MCMC iterations, discarding the first 20.000 iterations as the burn-in, and the corresponding 95% credibility intervals. Despite the wide 95% credibility intervals, the estimates show why such a first-order dependence is useful. Based on the mean estimates, many differences with the estimates of the atpB dataset, shown in Table 2, can be seen.</p></table-wrap-foot></table-wrap></sec></sec><sec><title>Discussion</title><p>While nucleotide context-dependent models can offer large improvements in terms of model fit to the data as compared to independent evolutionary models, their performance has to be compared to the performance of both codon-based and codon partition (CP) models. Shapiro et al. [<xref ref-type="bibr" rid="B1">1</xref>] state that few analyses in the literature on protein-coding sequences actually take into account the genetic code. Moreover, commonly employed model selection techniques (such as Modeltest by Posada and Crandall [<xref ref-type="bibr" rid="B2">2</xref>]) exclude codon-based models from the model comparisons, presumably due to the associated computational cost. Shapiro et al. [<xref ref-type="bibr" rid="B1">1</xref>] show, in alignments of 177 RNA virus genes and 106 yeast genes, that the codon-based GY94 model [<xref ref-type="bibr" rid="B10">10</xref>] is the model of choice for all the yeast genes and for 67% of the virus genes. However, due the computational cost the GY94 model seems only of use in smaller datasets. Compared to the independence models (such as the frequently used GTR + &#x00393; + I model), the CP models performed better on average for all the alignments analyzed. Such biologically motivated CP models are hence a computationally feasible alternative to codon-based models for use with protein-coding sequences, frequently outperforming standard nucleotide models.</p><p>We have shown in this paper that the computational requirements for integrating full codon models in a thermodynamic integration framework for model comparison increase drastically. While we have focused on the model of Goldman and Yang [<xref ref-type="bibr" rid="B10">10</xref>] as the full codon model of choice in this paper, better performing codon models have been developed (we refer to [<xref ref-type="bibr" rid="B28">28</xref>] for a review on codon substitution models). A study on full codon models is however beyond the scope of this paper, as the main goal was to show that current codon partition models can be approved upon at a computational cost below that of full codon models.</p><p>We have shown in this work that codon partition models that are extended with a context-dependence pattern for the third codon position across the entire underlying phylogenetic tree (so-called context-dependent codon partition models) significantly improve model fit compared to traditional codon partition models. While this work was mainly inspired by empirical findings [<xref ref-type="bibr" rid="B11">11</xref>], other context-dependent assumptions to extend traditional codon partition models can be devised and tested, which is the subject of ongoing work. The models proposed in this paper illustrate the complex (context-dependent) substitution patterns at the third codon position, along with increased rates of evolution at that position.</p><p>The approach we have taken to model context-dependent evolution at the third codon position selects one of 16 models using the neighbouring base combination at the start of each branch, which means that for a given site the context might change at each internal node of the underlying phylogenetic tree. A limiting aspect of this approach however is that the neighbouring base combination is assumed not to change along the length of a branch. This leads to only one in three codon positions (i.e. the third codon position and its two immediate neighbours) that can undergo substitutions, which is an assumption similar to that of full codon models (i.e. only one position in the codon can undergo substitutions). Contrary to the original context-dependent model developed for non-coding sequences [<xref ref-type="bibr" rid="B13">13</xref>], the evolution of the third codon position could be allowed to depend upon the neighbouring base combination at both the start and the end of each branch. However, such an assumption leads to 256 possible combinations of neighbours, instead of 16 used in this paper. It therefore seems highly unlikely that a sufficient performance increase is obtained to overthrow the penalty in model fit for the additional parameters. We have hence refrained from testing such an assumption in this paper.</p><p>Apart from drastically increasing the number of parameters to model the evolution at the third codon position more closely, as indicated in the previous paragraph, a continuous-time approximation is often used to allow the neighbouring base combinations to evolve along the length of a branch. The approach we've taken to do this partitions each branch into parts with length no greater than 0.005 [<xref ref-type="bibr" rid="B29">29</xref>]. As we have shown for non-coding sequences [<xref ref-type="bibr" rid="B17">17</xref>], this approach does not yield significantly differing substitution parameter estimates or ancestral root distribution estimates. However, such an approach does lead to higher log Bayes factors compared to when the branches are not split into parts. Given that this approach does not lead to significantly different parameter estimates, the increased log Bayes factor can be attributed to the more accurate approximation of the context-dependent Markov substitution process by allowing the ancestral sequences to change in between the internal speciation nodes [<xref ref-type="bibr" rid="B17">17</xref>].</p><p>The results shown in this paper hence support the notion that four-fold degenerate sites in the atpB and rbcL protein-coding genes of land plants have a substitution process that is dependent on the composition of its neighbouring bases. In the work that inspired this paper, Morton [<xref ref-type="bibr" rid="B11">11</xref>] suggested that a plausible explanation for such context dependence lies with misincorporations by either the DNA polymerase or the mismatch repair process. We refer to different papers by Morton [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B30">30</xref>] and Morton et al. [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>] for additional plausible explanations for context dependence in the chloroplast genome and to the paper of Hawk et al. [<xref ref-type="bibr" rid="B33">33</xref>] for a study on the variation in the efficiency of DNA mismatch repair at different sites in the yeast genome.</p><p>Even though we have found that the same context-dependent codon partition model performed best amongst all considered competing models for both atpB and rbcL genes, we have shown that the (context-dependent) substitution patterns at the third codon position differ greatly between both datasets. This means that, should both genes be concatenated to form a larger alignment, different context-dependent codon partition models may need to be used for each gene to perform accurate phylogenetic reconstruction for such a concatenated alignment. The substitution patterns discussed in this paper hence provide additional indications that great care needs to be taken in the analysis of concatenated genes.</p><p>As we have introduced the concept of context-dependent codon partition models in this paper, we have not yet undertaken an attempt to perform phylogenetic inference on protein-coding sequences using these models as the relationship between (increases in) model fit and the ability to accurately reconstruct phylogenetic trees is intricately complex [<xref ref-type="bibr" rid="B9">9</xref>]. In order to perform an extensive phylogenetic study on the context-dependent codon partition models we have introduced in this paper, additional context-dependent codon partition models need to be programmed and compared against the models presented in this paper, which is the subject of ongoing work. Indeed, while this paper introduces a class of context-dependent codon partition models, only one type of such models is discussed (i.e. those where the evolution of the third codon position depends upon its two immediate neighbours). However, a whole range of such models can be developed, which may for example be aimed towards mimicking full codon models more closely, which was not the aim of this study. The performance of these models can then be compared to the performance of a range of full codon models, in the interest of performing a study on inferring phylogenies. Specifically, the comparison with the codon model of Muse and Gaut [<xref ref-type="bibr" rid="B34">34</xref>] would be interesting, since this model, and its derivative MG-type models, relies on estimating only 12 equilibrium frequencies, whereas GY-type models estimate 61 equilibrium codon frequencies [<xref ref-type="bibr" rid="B28">28</xref>]. A thorough model comparison, like the one we've performed on non-coding sequences [<xref ref-type="bibr" rid="B35">35</xref>], is necessary to determine an accurate evolutionary model for phylogenetic inference.</p><p>The computational burden of our context-dependent codon partition models is, as for standard CP models, much lower than for actual codon models due to the decrease in number of parameters and the easier computation of eigenvalues and eigenvectors of the substitution matrices. Indeed, the spectral decomposition of the codon probability matrix (i.e. model) as well as the computation of its powers is considerably slower than for a nucleotide model. Computational effort in computing the eigenvalues and eigenvectors of a matrix rises as the cube of the number of rows or columns, hence the effort is 61<sup>3</sup>/4<sup>3 </sup>&#x02248; 3,547 times greater for a codon than for a nucleotide model [<xref ref-type="bibr" rid="B36">36</xref>]. Since our best-performing context-dependent codon partition model uses 20 nucleotide models to estimates its parameters, computational efforts of a codon model vis-&#x000e0;-vis this model are to 61<sup>3</sup>/(20&#x000d7;4<sup>3</sup>) &#x02248; 222 times greater. In other words,</p><p>codon partition models (context-dependent or not) replace the high dimensionality of codon models by a series (or combination) of low dimensional matrices, for which spectral decomposition requires much less computational efforts.</p><p>The computational differences listed in the above paragraph are theoretical however, since often other estimations (such as data augmentation) need to be performed alongside eigenvalue decompositions, which do not require calculation of new eigenvalues. We have hence measured the computation time for the different classes of model present in this paper and have listed the results in Table <xref ref-type="table" rid="T5">5</xref>. Given the many different calculations we had to perform, two different systems were used to obtain the results. The architecture used to perform the thermodynamic integration for the codon partition models (CP), context-dependent codon partition models (CDCP) and GY94 model with equal rates is a 4-core AMD Opteron 2356 processor (B3 stepping) clocked at 2.3 Ghz, which has 2 Mb L3 cache, requires DDR2 memory and was introduced in April 2008. The architecture used for the GY94 model with among-codon rate variation is a 8-core Intel Xeon X7560 clocked at 2.27 Ghz, which has 24 Mb L3 cache, requires DDR3 memory and was introduced in March 2010. Note that our software routines are single-threaded. Given the methodology we presented in this paper, it can be concluded that in the thermodynamic integration framework the CDCP models are roughly 2 times more demanding than the existing CP models, whereas the GY94 model with equal rates requires roughly 26 times the computational demands of the existing CP models. The comparison with the GY94 model with among-codon rate variation is more difficult since a different processor architecture was used for those calculations.</p><table-wrap id="T5" position="float"><label>Table 5</label><caption><p>Computational demands: number of iterations and computation time for the comparison of the different models in the thermodynamic integration framework.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center">Model</th><th align="center">Iterations</th><th align="center">System</th><th align="center">Time</th><th align="center">Time (corr.)</th></tr></thead><tbody><tr><td align="center">CP</td><td align="center">1.020.000</td><td align="center">4-core Opteron</td><td align="center">7d 23 h</td><td align="center">-</td></tr><tr><td align="center">CDCP</td><td align="center">1.050.000</td><td align="center">4-core Opteron</td><td align="center">16d 7 h</td><td align="center">-</td></tr><tr><td align="center">GY94</td><td align="center">300.000</td><td align="center">4-core Opteron</td><td align="center">57d 21 h</td><td align="center">203 days</td></tr><tr><td align="center">GY94+&#x00393;</td><td align="center">150.000</td><td align="center">8-core Xeon</td><td align="center">29d 21 h</td><td align="center">210 days</td></tr></tbody></table><table-wrap-foot><p>The first column shows the type of model being considered: CP (codon partition), CDCP (context-dependent codon partition), with the most parameter-rich in each of these classes being chosen to provide the computational estimates. The second column contains the number of Bayesian MCMC iterations for the comparison of each class of models vis-&#x000e0;-vis the GTR model in the thermodynamic integration framework. Given the increased computational demands, fewer iterations were run for the GY94 model, which is reflected in the annealing and melting estimates being further apart (see Results section). The third column lists the computer architecture on which the calculations were run. The fourth column contains the computation time for the model comparisons if they would be executed on a single processor core. Finally, the fifth column provides an estimate of the computation time required for the GY94 model should an equal amount of iterations be run as for the CP and CDCP models.</p></table-wrap-foot></table-wrap></sec><sec><title>Conclusions</title><p>Designing accurate context-dependent models is a complex process, with many different assumptions that require testing using an accurate procedure for model testing, which is computationally very demanding. In this paper, we show that current codon partition models may benefit from allowing the evolution of four-fold degenerate sites to depend upon the two immediate neighboring sites. Hence, the models we present here do not simply present an intermediate step between codon partition models and full codon models, given that the dependency patterns studied transcend the codon boundaries. Hence, dependencies are inferred that cannot be inferred even from high-dimensional full codon models.</p><p>Our analyses of the atpB and rbcL coding regions of a dataset of land plants show that the context-dependent codon partition models presented in this paper significantly outperform current codon partition models. Further, even though for both datasets the same model is selected as yielding the highest increase in model fit, the parameter estimates indicate different substitution patterns in these datasets from a context-dependent point of view. Additional datasets will need to be analyzed to further study these substitution patterns and the way they differ among protein-coding genes.</p></sec><sec><title>Authors' contributions</title><p>GB initiated the study, designed the context-dependent codon partition models and the different ancestral root distributions accompanying these models, performed all the analyses, programmed the software routines and wrote a first complete version of the manuscript. YVdP contributed biological expertise to the analyses. SV contributed statistical expertise to the analyses and edited the manuscript. All authors read and approved the final manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>Baele et al - Supplementary Material</bold>. File containing supplementary material and information that was not included in the main document. Word 2003 format.</p></caption><media xlink:href="1471-2148-11-145-S1.DOC" mimetype="application" mime-subtype="msword"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><sec><title>Acknowledgements</title><p>We would like to thank three anonymous reviewers for helpful comments concerning a first version of the manuscript. Yves Van de Peer acknowledges support from an Interuniversity Attraction Pole (IUAP) grant for the BioMaGNet project (Bioinformatics and Modelling: from Genomes to Networks, ref. p6/25). Stijn Vansteelandt acknowledges support from IAP research network grant nr. P06/03 from the Belgian government (Belgian Science Policy). We acknowledge the support of Ghent University (Multidisciplinary Research Partnership "Bioinformatics: from nucleotides to networks"). The research leading to these results has received funding from the European Research Council under the European Community's Seventh Framework Programme (FP7/2007-2013)/ERC Grant agreement n&#x000b0; 260864.</p></sec><ref-list><ref id="B1"><mixed-citation publication-type="journal"><name><surname>Shapiro</surname><given-names>B</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name><article-title>Choosing appropriate substitution models for the phylogenetic analysis of protein-coding sequences</article-title><source>Mol Biol Evol</source><year>2006</year><volume>23</volume><issue>1</issue><fpage>7</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">16177232</pub-id></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><name><surname>Posada</surname><given-names>D</given-names></name><name><surname>Crandall</surname><given-names>KA</given-names></name><article-title>MODELTEST: testing the model of DNA substitution</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><issue>9</issue><fpage>817</fpage><lpage>818</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.817</pub-id><pub-id pub-id-type="pmid">9918953</pub-id></mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><name><surname>Karol</surname><given-names>KG</given-names></name><name><surname>McCourt</surname><given-names>RM</given-names></name><name><surname>Cimino</surname><given-names>MT</given-names></name><name><surname>Delwiche</surname><given-names>CF</given-names></name><article-title>The closest living relatives of land plants</article-title><source>Science</source><year>2001</year><volume>294</volume><issue>5550</issue><fpage>2351</fpage><lpage>2353</lpage><pub-id pub-id-type="doi">10.1126/science.1065156</pub-id><pub-id pub-id-type="pmid">11743201</pub-id></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="journal"><name><surname>Hall</surname><given-names>JC</given-names></name><name><surname>Sytsma</surname><given-names>KJ</given-names></name><name><surname>Iltis</surname><given-names>HH</given-names></name><article-title>Phylogeny of Capparaceae and Brassicaceae based on chloroplast sequence data</article-title><source>Am J Bot</source><year>2002</year><volume>89</volume><issue>11</issue><fpage>1826</fpage><lpage>1842</lpage><pub-id pub-id-type="doi">10.3732/ajb.89.11.1826</pub-id></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><name><surname>Beilstein</surname><given-names>MA</given-names></name><name><surname>Al-Shehbaz</surname><given-names>IA</given-names></name><name><surname>Kellogg</surname><given-names>EA</given-names></name><article-title>Brassicaceae phylogeny and trichome evolution</article-title><source>Am J Bot</source><year>2006</year><volume>93</volume><issue>4</issue><fpage>607</fpage><lpage>619</lpage><pub-id pub-id-type="doi">10.3732/ajb.93.4.607</pub-id></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="journal"><name><surname>Gontcharov</surname><given-names>AA</given-names></name><name><surname>Marin</surname><given-names>B</given-names></name><name><surname>Melkonian</surname><given-names>M</given-names></name><article-title>Are combined analyses better than single gene phylogenies? A case study using SSU rDNA and rbcL sequence comparisons in the Zygnematophyceae (Streptophyta)</article-title><source>Molecular Biology and Evolution</source><year>2004</year><volume>21</volume><issue>3</issue><fpage>612</fpage><lpage>624</lpage><pub-id pub-id-type="pmid">14739253</pub-id></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="journal"><name><surname>Lanave</surname><given-names>C</given-names></name><name><surname>Preparata</surname><given-names>G</given-names></name><name><surname>Saccone</surname><given-names>C</given-names></name><name><surname>Serio</surname><given-names>G</given-names></name><article-title>A New Method for Calculating Evolutionary Substitution Rates</article-title><source>Journal of Molecular Evolution</source><year>1984</year><volume>20</volume><issue>1</issue><fpage>86</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1007/BF02101990</pub-id><pub-id pub-id-type="pmid">6429346</pub-id></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>ZH</given-names></name><article-title>Among-site rate variation and its impact on phylogenetic analyses</article-title><source>Trends in Ecology &#x00026; Evolution</source><year>1996</year><volume>11</volume><issue>9</issue><fpage>367</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1016/0169-5347(96)10041-0</pub-id><pub-id pub-id-type="pmid">21237881</pub-id></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>FR</given-names></name><name><surname>Tanaka</surname><given-names>H</given-names></name><name><surname>Yang</surname><given-names>ZH</given-names></name><article-title>An empirical examination of the utility of codon-substitution models in phylogeny reconstruction</article-title><source>Systematic Biol</source><year>2005</year><volume>54</volume><issue>5</issue><fpage>808</fpage><lpage>818</lpage><pub-id pub-id-type="doi">10.1080/10635150500354688</pub-id></mixed-citation></ref><ref id="B10"><mixed-citation publication-type="journal"><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>ZH</given-names></name><article-title>Codon-Based Model of Nucleotide Substitution for Protein-Coding DNA-Sequences</article-title><source>Molecular Biology and Evolution</source><year>1994</year><volume>11</volume><issue>5</issue><fpage>725</fpage><lpage>736</lpage><pub-id pub-id-type="pmid">7968486</pub-id></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>BR</given-names></name><article-title>The influence of neighboring base composition on substitutions in plant chloroplast coding sequences</article-title><source>Molecular Biology and Evolution</source><year>1997</year><volume>14</volume><issue>2</issue><fpage>189</fpage><lpage>194</lpage></mixed-citation></ref><ref id="B12"><mixed-citation publication-type="book"><name><surname>Jukes</surname><given-names>TH</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name><source>Evolution of protein molecules</source><year>1969</year><publisher-name>New York: Academic Press</publisher-name></mixed-citation></ref><ref id="B13"><mixed-citation publication-type="journal"><name><surname>Baele</surname><given-names>G</given-names></name><name><surname>Van de Peer</surname><given-names>Y</given-names></name><name><surname>Vansteelandt</surname><given-names>S</given-names></name><article-title>A Model-Based Approach to Study Nearest-Neighbor Influences Reveals Complex Substitution Patterns in Non-coding Sequences</article-title><source>Systematic Biol</source><year>2008</year><volume>57</volume><issue>5</issue><fpage>675</fpage><lpage>692</lpage><pub-id pub-id-type="doi">10.1080/10635150802422324</pub-id></mixed-citation></ref><ref id="B14"><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>ZH</given-names></name><article-title>Maximum-likelihood models for combined analyses of multiple sequence data</article-title><source>Journal of Molecular Evolution</source><year>1996</year><volume>42</volume><issue>5</issue><fpage>587</fpage><lpage>596</lpage><pub-id pub-id-type="doi">10.1007/BF02352289</pub-id><pub-id pub-id-type="pmid">8662011</pub-id></mixed-citation></ref><ref id="B15"><mixed-citation publication-type="journal"><name><surname>Hasegawa</surname><given-names>M</given-names></name><name><surname>Kishino</surname><given-names>H</given-names></name><name><surname>Yano</surname><given-names>TA</given-names></name><article-title>Dating of the Human Ape Splitting by a Molecular Clock of Mitochondrial-DNA</article-title><source>Journal of Molecular Evolution</source><year>1985</year><volume>22</volume><issue>2</issue><fpage>160</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1007/BF02101694</pub-id><pub-id pub-id-type="pmid">3934395</pub-id></mixed-citation></ref><ref id="B16"><mixed-citation publication-type="journal"><name><surname>Burgess</surname><given-names>R</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name><article-title>Estimation of hominoid ancestral population sizes under bayesian coalescent models incorporating mutation rate variation and sequencing errors</article-title><source>Mol Biol Evol</source><year>2008</year><volume>25</volume><issue>9</issue><fpage>1979</fpage><lpage>1994</lpage><pub-id pub-id-type="doi">10.1093/molbev/msn148</pub-id><pub-id pub-id-type="pmid">18603620</pub-id></mixed-citation></ref><ref id="B17"><mixed-citation publication-type="other"><name><surname>Baele</surname><given-names>G</given-names></name><name><surname>Van de Peer</surname><given-names>Y</given-names></name><name><surname>Vansteelandt</surname><given-names>S</given-names></name><article-title>Modelling the ancestral sequence distribution and model frequencies in context-dependent models for primate non-coding sequences</article-title><source>Bmc Evol Biol</source><year>2010</year></mixed-citation></ref><ref id="B18"><mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title><source>J Mol Evol</source><year>1981</year><volume>17</volume><issue>6</issue><fpage>368</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1007/BF01734359</pub-id><pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation></ref><ref id="B19"><mixed-citation publication-type="book"><name><surname>Gilks</surname><given-names>WR</given-names></name><name><surname>Richardson</surname><given-names>S</given-names></name><name><surname>Spiegelhalter</surname><given-names>DJ</given-names></name><source>Markov chain Monte Carlo in practice</source><year>1996</year><publisher-name>London: Chapman &#x00026; Hall</publisher-name></mixed-citation></ref><ref id="B20"><mixed-citation publication-type="journal"><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name><surname>Ronquist</surname><given-names>F</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Bollback</surname><given-names>JP</given-names></name><article-title>Bayesian inference of phylogeny and its impact on evolutionary biology</article-title><source>Science</source><year>2001</year><volume>294</volume><issue>5550</issue><fpage>2310</fpage><lpage>2314</lpage><pub-id pub-id-type="doi">10.1126/science.1065889</pub-id><pub-id pub-id-type="pmid">11743192</pub-id></mixed-citation></ref><ref id="B21"><mixed-citation publication-type="journal"><name><surname>Tanner</surname><given-names>MA</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name><article-title>The calculation of posterior distributions by data augmentation</article-title><source>J Am Stat Assoc</source><year>1987</year><volume>82</volume><issue>398</issue><fpage>528</fpage><lpage>540</lpage><pub-id pub-id-type="doi">10.2307/2289457</pub-id></mixed-citation></ref><ref id="B22"><mixed-citation publication-type="journal"><name><surname>Steel</surname><given-names>M</given-names></name><article-title>Should phylogenetic models be trying to "fit an elephant"?</article-title><source>Trends Genet</source><year>2005</year><volume>21</volume><issue>6</issue><fpage>307</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2005.04.001</pub-id><pub-id pub-id-type="pmid">15922824</pub-id></mixed-citation></ref><ref id="B23"><mixed-citation publication-type="journal"><name><surname>Kass</surname><given-names>RE</given-names></name><name><surname>Raftery</surname><given-names>AE</given-names></name><article-title>Bayes Factors</article-title><source>J Am Stat Assoc</source><year>1995</year><volume>90</volume><issue>430</issue><fpage>773</fpage><lpage>795</lpage><pub-id pub-id-type="doi">10.2307/2291091</pub-id></mixed-citation></ref><ref id="B24"><mixed-citation publication-type="journal"><name><surname>Lartillot</surname><given-names>N</given-names></name><name><surname>Philippe</surname><given-names>H</given-names></name><article-title>Computing Bayes factors using thermodynamic integration</article-title><source>Systematic Biol</source><year>2006</year><volume>55</volume><issue>2</issue><fpage>195</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1080/10635150500433722</pub-id></mixed-citation></ref><ref id="B25"><mixed-citation publication-type="journal"><name><surname>Baele</surname><given-names>G</given-names></name><name><surname>Peer</surname><given-names>YV</given-names></name><name><surname>Vansteelandt</surname><given-names>S</given-names></name><article-title>Efficient context-dependent model building based on clustering posterior distributions for non-coding sequences</article-title><source>Bmc Evol Biol</source><year>2009</year><volume>9</volume><fpage>87</fpage><pub-id pub-id-type="doi">10.1186/1471-2148-9-87</pub-id><pub-id pub-id-type="pmid">19405957</pub-id></mixed-citation></ref><ref id="B26"><mixed-citation publication-type="journal"><name><surname>Suchard</surname><given-names>MA</given-names></name><name><surname>Weiss</surname><given-names>RE</given-names></name><name><surname>Sinsheimer</surname><given-names>JS</given-names></name><article-title>Bayesian selection of continuous-time Markov chain evolutionary models</article-title><source>Molecular Biology and Evolution</source><year>2001</year><volume>18</volume><issue>6</issue><fpage>1001</fpage><lpage>1013</lpage><pub-id pub-id-type="pmid">11371589</pub-id></mixed-citation></ref><ref id="B27"><mixed-citation publication-type="journal"><name><surname>Zwickl</surname><given-names>DJ</given-names></name><name><surname>Holder</surname><given-names>MT</given-names></name><article-title>Model parameterization, prior distributions, and the general time-reversible model in Bayesian phylogenetics</article-title><source>Systematic Biol</source><year>2004</year><volume>53</volume><issue>6</issue><fpage>877</fpage><lpage>888</lpage><pub-id pub-id-type="doi">10.1080/10635150490522584</pub-id></mixed-citation></ref><ref id="B28"><mixed-citation publication-type="journal"><name><surname>Anisimova</surname><given-names>M</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name><article-title>Investigating protein-coding sequence evolution with probabilistic codon substitution models</article-title><source>Molecular Biology and Evolution</source><year>2009</year><volume>26</volume><issue>2</issue><fpage>255</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1093/molbev/msn232</pub-id><pub-id pub-id-type="pmid">18922761</pub-id></mixed-citation></ref><ref id="B29"><mixed-citation publication-type="journal"><name><surname>Hwang</surname><given-names>DG</given-names></name><name><surname>Green</surname><given-names>P</given-names></name><article-title>Bayesian Markov chain Monte Carlo sequence analysis reveals varying neutral substitution patterns in mammalian evolution</article-title><source>P Natl Acad Sci USA</source><year>2004</year><volume>101</volume><issue>39</issue><fpage>13994</fpage><lpage>14001</lpage><pub-id pub-id-type="doi">10.1073/pnas.0404142101</pub-id></mixed-citation></ref><ref id="B30"><mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>BR</given-names></name><article-title>Neighboring base composition and transversion/transition bias in a comparison of rice and maize chloroplast noncoding regions</article-title><source>P Natl Acad Sci USA</source><year>1995</year><volume>92</volume><issue>21</issue><fpage>9717</fpage><lpage>9721</lpage><pub-id pub-id-type="doi">10.1073/pnas.92.21.9717</pub-id></mixed-citation></ref><ref id="B31"><mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>BR</given-names></name><name><surname>Oberholzer</surname><given-names>VM</given-names></name><name><surname>Clegg</surname><given-names>MT</given-names></name><article-title>The influence of specific neighboring bases on substitution bias in noncoding regions of the plant chloroplast genome</article-title><source>Journal of molecular evolution</source><year>1997</year><volume>45</volume><issue>3</issue><fpage>227</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1007/PL00006224</pub-id><pub-id pub-id-type="pmid">9302315</pub-id></mixed-citation></ref><ref id="B32"><mixed-citation publication-type="journal"><name><surname>Morton</surname><given-names>BR</given-names></name><name><surname>Bi</surname><given-names>IV</given-names></name><name><surname>McMullen</surname><given-names>MD</given-names></name><name><surname>Gaut</surname><given-names>BS</given-names></name><article-title>Variation in mutation dynamics across the maize genome as a function of regional and flanking base composition</article-title><source>Genetics</source><year>2006</year><volume>172</volume><issue>1</issue><fpage>569</fpage><lpage>577</lpage><pub-id pub-id-type="pmid">16219784</pub-id></mixed-citation></ref><ref id="B33"><mixed-citation publication-type="journal"><name><surname>Hawk</surname><given-names>JD</given-names></name><name><surname>Stefanovic</surname><given-names>L</given-names></name><name><surname>Boyer</surname><given-names>JC</given-names></name><name><surname>Petes</surname><given-names>TD</given-names></name><name><surname>Farber</surname><given-names>RA</given-names></name><article-title>Variation in efficiency of DNA mismatch repair at different sites in the yeast genome</article-title><source>P Natl Acad Sci USA</source><year>2005</year><volume>102</volume><issue>24</issue><fpage>8639</fpage><lpage>8643</lpage><pub-id pub-id-type="doi">10.1073/pnas.0503415102</pub-id></mixed-citation></ref><ref id="B34"><mixed-citation publication-type="journal"><name><surname>Muse</surname><given-names>SV</given-names></name><name><surname>Gaut</surname><given-names>BS</given-names></name><article-title>A likelihood approach for comparing synonymous and nonsynonymous substitution rates, with application to the chloroplast genome</article-title><source>Molecular Biology and Evolution</source><year>1994</year><volume>11</volume><issue>5</issue><fpage>715</fpage><lpage>724</lpage><pub-id pub-id-type="pmid">7968485</pub-id></mixed-citation></ref><ref id="B35"><mixed-citation publication-type="journal"><name><surname>Baele</surname><given-names>G</given-names></name><name><surname>Van de Peer</surname><given-names>Y</given-names></name><name><surname>Vansteelandt</surname><given-names>S</given-names></name><article-title>Using non-reversible context-dependent evolutionary models to study substitution patterns in primate non-coding sequences</article-title><source>Journal of molecular evolution</source><year>2010</year><volume>71</volume><issue>1</issue><fpage>34</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1007/s00239-010-9362-y</pub-id><pub-id pub-id-type="pmid">20623275</pub-id></mixed-citation></ref><ref id="B36"><mixed-citation publication-type="book"><name><surname>Felsenstein</surname><given-names>J</given-names></name><source>Inferring phylogenies</source><year>2004</year><publisher-name>Sunderland, Mass.: Sinauer Associates</publisher-name></mixed-citation></ref></ref-list></back></article>